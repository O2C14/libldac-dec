#include "ldac.h"
#include "tables.h"
const SCALAR sa_bwin_2fs_ldac[LDAC_2FSLSU] = {
    0.0000094125, 0.000084723, 0.0002354, 0.00046156, 0.00076337, 0.0011411,
    0.0015949,    0.0021253,   0.0027325, 0.0034171,  0.0041796,  0.0050206,
    0.0059406,    0.0069403,   0.0080206, 0.0091822,  0.010426,   0.011753,
    0.013164,     0.01466,     0.016242,  0.017912,   0.01967,    0.021519,
    0.023458,     0.02549,     0.027617,  0.029839,   0.032158,   0.034577,
    0.037096,     0.039717,    0.042443,  0.045276,   0.048216,   0.051267,
    0.05443,      0.057708,    0.061103,  0.064617,   0.068252,   0.072011,
    0.075897,     0.079911,    0.084057,  0.088338,   0.092755,   0.097311,
    0.10201,      0.10685,     0.11185,   0.11699,    0.12229,    0.12774,
    0.13336,      0.13914,     0.14508,   0.15119,    0.15748,    0.16394,
    0.17058,      0.1774,      0.1844,    0.19159,    0.19898,    0.20655,
    0.21433,      0.2223,      0.23047,   0.23884,    0.24743,    0.25622,
    0.26522,      0.27443,     0.28386,   0.2935,     0.30337,    0.31345,
    0.32375,      0.33427,     0.345,     0.35596,    0.36714,    0.37854,
    0.39016,      0.40199,     0.41403,   0.42629,    0.43875,    0.45143,
    0.4643,       0.47737,     0.49063,   0.50407,    0.5177,     0.5315,
    0.54546,      0.55959,     0.57386,   0.58827,    0.60281,    0.61747,
    0.63223,      0.6471,      0.66204,   0.67706,    0.69213,    0.70725,
    0.72239,      0.73755,     0.7527,    0.76784,    0.78294,    0.79799,
    0.81298,      0.82787,     0.84267,   0.85735,    0.87188,    0.88627,
    0.90048,      0.91451,     0.92833,   0.94194,    0.9553,     0.96841,
    0.98126,      0.99383,     1.0061,    1.0181,     1.0297,     1.041,
    1.052,        1.0626,      1.0729,    1.0828,     1.0923,     1.1014,
    1.1102,       1.1185,      1.1265,    1.1341,     1.1412,     1.148,
    1.1544,       1.1604,      1.166,     1.1712,     1.1761,     1.1805,
    1.1846,       1.1883,      1.1916,    1.1946,     1.1973,     1.1996,
    1.2016,       1.2032,      1.2046,    1.2056,     1.2064,     1.2069,
    1.2071,       1.207,       1.2067,    1.2062,     1.2054,     1.2044,
    1.2033,       1.2019,      1.2003,    1.1985,     1.1966,     1.1945,
    1.1923,       1.1899,      1.1874,    1.1848,     1.1821,     1.1792,
    1.1763,       1.1733,      1.1702,    1.167,      1.1638,     1.1605,
    1.1571,       1.1537,      1.1503,    1.1468,     1.1433,     1.1398,
    1.1363,       1.1328,      1.1292,    1.1257,     1.1221,     1.1186,
    1.1151,       1.1116,      1.1081,    1.1046,     1.1012,     1.0978,
    1.0944,       1.091,       1.0877,    1.0845,     1.0812,     1.0781,
    1.0749,       1.0718,      1.0688,    1.0658,     1.0629,     1.06,
    1.0572,       1.0544,      1.0517,    1.0491,     1.0465,     1.044,
    1.0415,       1.0391,      1.0368,    1.0345,     1.0323,     1.0302,
    1.0282,       1.0262,      1.0243,    1.0224,     1.0206,     1.0189,
    1.0173,       1.0157,      1.0142,    1.0128,     1.0115,     1.0102,
    1.009,        1.0079,      1.0068,    1.0059,     1.005,      1.0041,
    1.0034,       1.0027,      1.0021,    1.0016,     1.0011,     1.0008,
    1.0005,       1.0002,      1.0001,    1.0}; // idb
const SCALAR sa_wcos_2fs_ldac[LDAC_2FSLSU] = {
    0.70711,  0.92388,  -0.38268,  0.98079,  0.55557,   -0.19509,  -0.83147,
    0.99518,  0.88192,  0.63439,   0.29028,  -0.098017, -0.4714,   -0.77301,
    -0.95694, 0.9988,   0.97003,   0.90399,  0.80321,   0.67156,   0.5141,
    0.33689,  0.14673,  -0.049068, -0.24298, -0.42756,  -0.5957,   -0.74095,
    -0.85773, -0.94154, -0.98918,  0.9997,   0.99248,   0.9757,    0.94953,
    0.91421,  0.87009,  0.81758,   0.75721,  0.68954,   0.61523,   0.535,
    0.44961,  0.3599,   0.26671,   0.17096,  0.073565,  -0.024541, -0.12241,
    -0.2191,  -0.31368, -0.40524,  -0.4929,  -0.57581,  -0.65317,  -0.72425,
    -0.78835, -0.84485, -0.89322,  -0.93299, -0.96378,  -0.98528,  -0.99729,
    0.99992,  0.99812,  0.99391,   0.9873,   0.97832,   0.96698,   0.95331,
    0.93734,  0.91911,  0.89867,   0.87607,  0.85136,   0.82459,   0.79584,
    0.76517,  0.73265,  0.69838,   0.66242,  0.62486,   0.5858,    0.54532,
    0.50354,  0.46054,  0.41643,   0.37132,  0.32531,   0.27852,   0.23106,
    0.18304,  0.13458,  0.085797,  0.036807, -0.012272, -0.061321, -0.11022,
    -0.15886, -0.20711, -0.25487,  -0.30201, -0.34842,  -0.39399,  -0.43862,
    -0.48218, -0.52459, -0.56573,  -0.60551, -0.64383,  -0.6806,   -0.71573,
    -0.74914, -0.78074, -0.81046,  -0.83822, -0.86397,  -0.88764,  -0.90917,
    -0.92851, -0.94561, -0.96043,  -0.97294, -0.98311,  -0.9909,   -0.99631,
    -0.99932, 1.0,      0.99988,   0.99962,  0.9992,    0.99864,   0.99793,
    0.99706,  0.99604,  0.99488,   0.99356,  0.9921,    0.99049,   0.98872,
    0.98681,  0.98475,  0.98254,   0.98018,  0.97768,   0.97503,   0.97223,
    0.96928,  0.96619,  0.96295,   0.95957,  0.95605,   0.95237,   0.94856,
    0.9446,   0.94051,  0.93627,   0.93188,  0.92736,   0.9227,    0.9179,
    0.91296,  0.90789,  0.90267,   0.89732,  0.89184,   0.88622,   0.88047,
    0.87459,  0.86857,  0.86242,   0.85615,  0.84974,   0.84321,   0.83655,
    0.82976,  0.82285,  0.81581,   0.80866,  0.80138,   0.79398,   0.78646,
    0.77882,  0.77106,  0.76319,   0.7552,   0.7471,    0.73889,   0.73056,
    0.72213,  0.71358,  0.70493,   0.69618,  0.68732,   0.67835,   0.66928,
    0.66011,  0.65085,  0.64148,   0.63202,  0.62246,   0.61281,   0.60307,
    0.59323,  0.58331,  0.5733,    0.5632,   0.55302,   0.54275,   0.5324,
    0.52198,  0.51147,  0.50089,   0.49023,  0.47949,   0.46869,   0.45781,
    0.44687,  0.43586,  0.42478,   0.41364,  0.40243,   0.39117,   0.37985,
    0.36847,  0.35703,  0.34554,   0.334,    0.32241,   0.31077,   0.29908,
    0.28735,  0.27557,  0.26375,   0.2519,   0.24,      0.22807,   0.21611,
    0.20411,  0.19208,  0.18002,   0.16794,  0.15583,   0.1437,    0.13154,
    0.11937,  0.10717,  0.094963,  0.08274,  0.070505,  0.058258,  0.046003,
    0.033741, 0.021474, 0.0092038, 0.0}; // idb
const SCALAR *gaa_wcos_ldac[LDAC_NUMLNN];
const SCALAR sa_wsin_1fs_ldac[LDAC_1FSLSU] = {
    0.70711,   0.38268,  0.92388,  0.19509,  0.83147, 0.98079, 0.55557,
    0.098017,  0.4714,   0.77301,  0.95694,  0.99518, 0.88192, 0.63439,
    0.29028,   0.049068, 0.24298,  0.42756,  0.5957,  0.74095, 0.85773,
    0.94154,   0.98918,  0.9988,   0.97003,  0.90399, 0.80321, 0.67156,
    0.5141,    0.33689,  0.14673,  0.024541, 0.12241, 0.2191,  0.31368,
    0.40524,   0.4929,   0.57581,  0.65317,  0.72425, 0.78835, 0.84485,
    0.89322,   0.93299,  0.96378,  0.98528,  0.99729, 0.9997,  0.99248,
    0.9757,    0.94953,  0.91421,  0.87009,  0.81758, 0.75721, 0.68954,
    0.61523,   0.535,    0.44961,  0.3599,   0.26671, 0.17096, 0.073565,
    0.0061359, 0.030675, 0.055195, 0.079682, 0.10412, 0.1285,  0.1528,
    0.177,     0.2011,   0.22508,  0.24893,  0.27262, 0.29615, 0.3195,
    0.34266,   0.36561,  0.38835,  0.41084,  0.43309, 0.45508, 0.4768,
    0.49823,   0.51936,  0.54017,  0.56066,  0.58081, 0.60062, 0.62006,
    0.63912,   0.65781,  0.67609,  0.69397,  0.71143, 0.72846, 0.74506,
    0.7612,    0.77689,  0.79211,  0.80685,  0.8211,  0.83486, 0.84812,
    0.86087,   0.87309,  0.8848,   0.89597,  0.9066,  0.91668, 0.92621,
    0.93518,   0.94359,  0.95144,  0.9587,   0.96539, 0.9715,  0.97703,
    0.98196,   0.98631,  0.99006,  0.99321,  0.99577, 0.99772, 0.99908,
    0.99983,   0.0};             // idb
const int *gaa_rev_perm_ldac[LDAC_NUMLNN]; // idb
const SCALAR *gaa_bwin_ldac[LDAC_NUMLNN];  // idb
const SCALAR sa_wsin_2fs_ldac[LDAC_2FSLSU] = {
    0.70711,  0.38268,  0.92388,  0.19509,  0.83147,  0.98079,  0.55557,
    0.098017, 0.4714,   0.77301,  0.95694,  0.99518,  0.88192,  0.63439,
    0.29028,  0.049068, 0.24298,  0.42756,  0.5957,   0.74095,  0.85773,
    0.94154,  0.98918,  0.9988,   0.97003,  0.90399,  0.80321,  0.67156,
    0.5141,   0.33689,  0.14673,  0.024541, 0.12241,  0.2191,   0.31368,
    0.40524,  0.4929,   0.57581,  0.65317,  0.72425,  0.78835,  0.84485,
    0.89322,  0.93299,  0.96378,  0.98528,  0.99729,  0.9997,   0.99248,
    0.9757,   0.94953,  0.91421,  0.87009,  0.81758,  0.75721,  0.68954,
    0.61523,  0.535,    0.44961,  0.3599,   0.26671,  0.17096,  0.073565,
    0.012272, 0.061321, 0.11022,  0.15886,  0.20711,  0.25487,  0.30201,
    0.34842,  0.39399,  0.43862,  0.48218,  0.52459,  0.56573,  0.60551,
    0.64383,  0.6806,   0.71573,  0.74914,  0.78074,  0.81046,  0.83822,
    0.86397,  0.88764,  0.90917,  0.92851,  0.94561,  0.96043,  0.97294,
    0.98311,  0.9909,   0.99631,  0.99932,  0.99992,  0.99812,  0.99391,
    0.9873,   0.97832,  0.96698,  0.95331,  0.93734,  0.91911,  0.89867,
    0.87607,  0.85136,  0.82459,  0.79584,  0.76517,  0.73265,  0.69838,
    0.66242,  0.62486,  0.5858,   0.54532,  0.50354,  0.46054,  0.41643,
    0.37132,  0.32531,  0.27852,  0.23106,  0.18304,  0.13458,  0.085797,
    0.036807, 0.003068, 0.015339, 0.027608, 0.039873, 0.052132, 0.064383,
    0.076624, 0.088854, 0.10107,  0.11327,  0.12545,  0.13762,  0.14976,
    0.16189,  0.17398,  0.18606,  0.1981,   0.21011,  0.22209,  0.23404,
    0.24596,  0.25783,  0.26967,  0.28146,  0.29322,  0.30493,  0.31659,
    0.32821,  0.33978,  0.35129,  0.36276,  0.37416,  0.38552,  0.39681,
    0.40804,  0.41922,  0.43033,  0.44137,  0.45235,  0.46326,  0.4741,
    0.48487,  0.49557,  0.50619,  0.51673,  0.5272,   0.53759,  0.54789,
    0.55812,  0.56826,  0.57831,  0.58828,  0.59816,  0.60795,  0.61765,
    0.62725,  0.63676,  0.64618,  0.65549,  0.66471,  0.67383,  0.68285,
    0.69176,  0.70057,  0.70927,  0.71787,  0.72636,  0.73474,  0.74301,
    0.75117,  0.75921,  0.76714,  0.77495,  0.78265,  0.79023,  0.79769,
    0.80503,  0.81225,  0.81935,  0.82632,  0.83317,  0.83989,  0.84649,
    0.85296,  0.8593,   0.86551,  0.8716,   0.87755,  0.88336,  0.88905,
    0.8946,   0.90002,  0.9053,   0.91044,  0.91545,  0.92032,  0.92505,
    0.92964,  0.93409,  0.9384,   0.94257,  0.9466,   0.95049,  0.95423,
    0.95783,  0.96128,  0.96459,  0.96775,  0.97077,  0.97364,  0.97637,
    0.97895,  0.98138,  0.98366,  0.9858,   0.98778,  0.98962,  0.99131,
    0.99285,  0.99424,  0.99548,  0.99657,  0.99751,  0.9983,   0.99894,
    0.99943,  0.99977,  0.99996,  0.0}; // idb
const SCALAR *gaa_wsin_ldac[LDAC_NUMLNN];
const int sa_rev_perm_1fs_ldac[LDAC_1FSLSU] = {
    63, 64, 0, 127, 32, 95, 31, 96,  48, 79, 15, 112, 47, 80, 16, 111,
    56, 71, 7, 120, 39, 88, 24, 103, 55, 72, 8,  119, 40, 87, 23, 104,
    60, 67, 3, 124, 35, 92, 28, 99,  51, 76, 12, 115, 44, 83, 19, 108,
    59, 68, 4, 123, 36, 91, 27, 100, 52, 75, 11, 116, 43, 84, 20, 107,
    62, 65, 1, 126, 33, 94, 30, 97,  49, 78, 14, 113, 46, 81, 17, 110,
    57, 70, 6, 121, 38, 89, 25, 102, 54, 73, 9,  118, 41, 86, 22, 105,
    61, 66, 2, 125, 34, 93, 29, 98,  50, 77, 13, 114, 45, 82, 18, 109,
    58, 69, 5, 122, 37, 90, 26, 101, 53, 74, 10, 117, 42, 85, 21, 106}; // idb
const SCALAR sa_bwin_1fs_ldac[LDAC_1FSLSU] = {
    0.000037652, 0.00033904, 0.00094272, 0.0018505, 0.0030651, 0.0045903,
    0.0064304,   0.0085912,  0.011079,   0.013901,  0.017066,  0.020583,
    0.024463,    0.028716,   0.033355,   0.038394,  0.043846,  0.049728,
    0.056055,    0.062845,   0.070116,   0.077888,  0.086181,  0.095015,
    0.10441,     0.1144,     0.125,      0.13623,   0.14811,   0.16069,
    0.17396,     0.18798,    0.20274,    0.21829,   0.23463,   0.25179,
    0.2698,      0.28866,    0.30838,    0.32898,   0.35046,   0.37281,
    0.39604,     0.42013,    0.44506,    0.47081,   0.49733,   0.52458,
    0.55251,     0.58105,    0.61012,    0.63965,   0.66954,   0.69969,
    0.72997,     0.76028,    0.79048,    0.82044,   0.85002,   0.8791,
    0.90752,     0.93516,    0.96189,    0.98758,   1.0121,    1.0354,
    1.0573,      1.0779,     1.0969,     1.1144,    1.1303,    1.1447,
    1.1575,      1.1687,     1.1783,     1.1865,    1.1932,    1.1985,
    1.2024,      1.2052,     1.2067,     1.2071,    1.2065,    1.205,
    1.2026,      1.1994,     1.1956,     1.1911,    1.1861,    1.1806,
    1.1748,      1.1686,     1.1621,     1.1554,    1.1486,    1.1416,
    1.1345,      1.1275,     1.1204,     1.1133,    1.1064,    1.0995,
    1.0927,      1.0861,     1.0796,     1.0734,    1.0673,    1.0614,
    1.0558,      1.0504,     1.0452,     1.0403,    1.0356,    1.0313,
    1.0272,      1.0233,     1.0198,     1.0165,    1.0135,    1.0108,
    1.0084,      1.0063,     1.0045,     1.003,     1.0018,    1.0009,
    1.0003,      1.0}; // idb
const SCALAR sa_wcos_1fs_ldac[LDAC_1FSLSU] = {
    0.70711,  0.92388,  -0.38268,  0.98079,  0.55557,   -0.19509,  -0.83147,
    0.99518,  0.88192,  0.63439,   0.29028,  -0.098017, -0.4714,   -0.77301,
    -0.95694, 0.9988,   0.97003,   0.90399,  0.80321,   0.67156,   0.5141,
    0.33689,  0.14673,  -0.049068, -0.24298, -0.42756,  -0.5957,   -0.74095,
    -0.85773, -0.94154, -0.98918,  0.9997,   0.99248,   0.9757,    0.94953,
    0.91421,  0.87009,  0.81758,   0.75721,  0.68954,   0.61523,   0.535,
    0.44961,  0.3599,   0.26671,   0.17096,  0.073565,  -0.024541, -0.12241,
    -0.2191,  -0.31368, -0.40524,  -0.4929,  -0.57581,  -0.65317,  -0.72425,
    -0.78835, -0.84485, -0.89322,  -0.93299, -0.96378,  -0.98528,  -0.99729,
    0.99998,  0.99953,  0.99848,   0.99682,  0.99456,   0.99171,   0.98826,
    0.98421,  0.97957,  0.97434,   0.96852,  0.96212,   0.95514,   0.94759,
    0.93946,  0.93077,  0.92151,   0.91171,  0.90135,   0.89045,   0.87901,
    0.86705,  0.85456,  0.84155,   0.82805,  0.81404,   0.79954,   0.78456,
    0.7691,   0.75319,  0.73682,   0.72,     0.70275,   0.68508,   0.667,
    0.64851,  0.62964,  0.61038,   0.59076,  0.57078,   0.55046,   0.5298,
    0.50883,  0.48755,  0.46598,   0.44412,  0.422,     0.39962,   0.37701,
    0.35416,  0.33111,  0.30785,   0.28441,  0.26079,   0.23702,   0.21311,
    0.18907,  0.16491,  0.14066,   0.11632,  0.091909,  0.067444,  0.042938,
    0.018407, 0.0}; // idb
const int sa_rev_perm_2fs_ldac[LDAC_2FSLSU] = {
    127, 128, 0,   255, 64,  191, 63,  192, 96,  159, 31,  224, 95,  160, 32,
    223, 112, 143, 15,  240, 79,  176, 48,  207, 111, 144, 16,  239, 80,  175,
    47,  208, 120, 135, 7,   248, 71,  184, 56,  199, 103, 152, 24,  231, 88,
    167, 39,  216, 119, 136, 8,   247, 72,  183, 55,  200, 104, 151, 23,  232,
    87,  168, 40,  215, 124, 131, 3,   252, 67,  188, 60,  195, 99,  156, 28,
    227, 92,  163, 35,  220, 115, 140, 12,  243, 76,  179, 51,  204, 108, 147,
    19,  236, 83,  172, 44,  211, 123, 132, 4,   251, 68,  187, 59,  196, 100,
    155, 27,  228, 91,  164, 36,  219, 116, 139, 11,  244, 75,  180, 52,  203,
    107, 148, 20,  235, 84,  171, 43,  212, 126, 129, 1,   254, 65,  190, 62,
    193, 97,  158, 30,  225, 94,  161, 33,  222, 113, 142, 14,  241, 78,  177,
    49,  206, 110, 145, 17,  238, 81,  174, 46,  209, 121, 134, 6,   249, 70,
    185, 57,  198, 102, 153, 25,  230, 89,  166, 38,  217, 118, 137, 9,   246,
    73,  182, 54,  201, 105, 150, 22,  233, 86,  169, 41,  214, 125, 130, 2,
    253, 66,  189, 61,  194, 98,  157, 29,  226, 93,  162, 34,  221, 114, 141,
    13,  242, 77,  178, 50,  205, 109, 146, 18,  237, 82,  173, 45,  210, 122,
    133, 5,   250, 69,  186, 58,  197, 101, 154, 26,  229, 90,  165, 37,  218,
    117, 138, 10,  245, 74,  181, 53,  202, 106, 149, 21,  234, 85,  170, 42,
    213}; // idb
const SCALAR ga_rsf_ldac[LDAC_NIDWL] = {
    1.0,        0.33333,     0.14286,     0.066667,   0.032258,   0.015873,
    0.007874,   0.0039216,   0.0019569,   0.00097752, 0.00048852, 0.0002442,
    0.00012209, 0.000061039, 0.000030519, 0.000015259};
const SCALAR ga_sf_ldac[LDAC_NIDSF] = {
    0.000030518, 0.000061035, 0.00012207, 0.00024414, 0.00048828, 0.00097656,
    0.0019531,   0.0039062,   0.0078125,  0.015625,   0.03125,    0.0625,
    0.125,       0.25,        0.5,        1.0,        2.0,        4.0,
    8.0,         16.0,        32.0,       64.0,       128.0,      256.0,
    512.0,       1024.0,      2048.0,     4096.0,     8192.0,     16384.0,
    32768.0,     65536.0};
const SCALAR ga_iqf_ldac[LDAC_NIDWL] = {
    2.0,        0.66667,    0.28571,     0.13333,    0.064516,   0.031746,
    0.015748,   0.0078431,  0.0039139,   0.001955,   0.00097704, 0.0004884,
    0.00024417, 0.00012208, 0.000061037, 0.000030518};

DECLFUNC void set_imdct_table_ldac(int nlnn) {
  if (nlnn == LDAC_1FSLNN) {
    gaa_wsin_ldac[0] = sa_wsin_1fs_ldac;
    gaa_rev_perm_ldac[0] = sa_rev_perm_1fs_ldac;
    gaa_bwin_ldac[0] = sa_bwin_1fs_ldac;
    gaa_wcos_ldac[0] = sa_wcos_1fs_ldac;
  } else if (nlnn == LDAC_2FSLNN) {
    gaa_wsin_ldac[1] = sa_wsin_2fs_ldac;
    gaa_rev_perm_ldac[1] = sa_rev_perm_2fs_ldac;
    gaa_bwin_ldac[1] = sa_bwin_2fs_ldac;
    gaa_wcos_ldac[1] = sa_wcos_2fs_ldac;
  }
}

